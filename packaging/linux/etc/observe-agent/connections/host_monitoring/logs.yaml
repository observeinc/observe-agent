receivers:
  filelog/host_monitoring:
    include:
      - /var/log/**/*.log
      - /var/log/syslog
      {{- range .Logs.Include }}
      - {{ . }}
      {{- end }}
    include_file_path: true
    storage: file_storage
    retry_on_failure:
      enabled: true
    max_log_size: 4MiB
    operators:
      - type: filter
        expr: 'body matches "otel-contrib"'

  journald/host_monitoring:
    units:
      - cron
      - ssh
      - systemd-networkd
      - systemd-resolved
      - systemd-login
      - multipathd
      - systemd-user-sessions
      - ufw
      - observe-agent
    priority: info

service:
  pipelines:
    logs/host_monitoring-file:
      receivers: [filelog/host_monitoring]
      processors: [memory_limiter, transform/truncate, resourcedetection, resourcedetection/cloud, batch]
      exporters: [otlphttp/observe, count]

    logs/host_monitoring-journald:
      receivers: [journald/host_monitoring]
      processors: [memory_limiter, transform/truncate, resourcedetection, resourcedetection/cloud, batch]
      exporters: [otlphttp/observe, count]
